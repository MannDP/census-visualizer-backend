(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{373:function(e,t,a){e.exports=a(839)},827:function(e,t,a){},828:function(e,t,a){},839:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(17),c=a.n(i),s=a(8),l=a.n(s),o=a(16),u=a(31),m=a(33),d=a(38),p=a(37),f=a(182),h=a(848),v=a(346),y=a(847),g=a(853),b=a(850),E=a(851),k=a(162),w=a(47),q=a(29),x=[Object(o.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.getItem("UserSession");case 2:if(null!==(t=e.sent)){e.next=5;break}return e.abrupt("return");case 5:a=JSON.parse(t),F.authToken=a.token,F.userInfo={firstName:a.firstName,lastName:a.lastName};case 8:case"end":return e.stop()}}),e)})))],S=function(){function e(){Object(u.a)(this,e),this.isLoading=!0}return Object(m.a)(e,[{key:"fetchItems",value:function(){var e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.next=3,Promise.all(x.map((function(e){return e()})));case 3:this.isLoading=!1;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setItem",value:function(e,t){localStorage.setItem(e.valueOf(),JSON.stringify(t))}},{key:"clearItem",value:function(e){localStorage.removeItem(e.valueOf())}}]),e}();Object(q.d)(S,{isLoading:q.f,fetchItems:q.b});var C=new S,O=a(340),j=a.n(O),I=function e(){Object(u.a)(this,e)};I.createRequest=function(e,t,a){return new Promise(function(){var n=Object(o.a)(l.a.mark((function n(r,i){var c,s;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,j.a.request({url:"".concat("http://census-viz.herokuapp.com/").concat(e),method:t,headers:{Authorization:F.authToken&&"Bearer ".concat(F.authToken)||"","Content-Type":"application/json"},data:void 0===a?void 0:a});case 3:c=n.sent,r(c.data),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),s=n.t0.response.data,i(s);case 11:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e,t){return n.apply(this,arguments)}}())},I.signUpUser=function(){var e=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/register","POST",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.signInUser=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/login","POST",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.fetchAllQueries=Object(o.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/saved_queries","GET");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)}))),I.saveQuery=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/save_queries","POST",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.deleteQueries=function(){var e=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/delete_queries","POST",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.runQueries=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/query_by_id","POST",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.getUserMe=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/me","GET",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.updateDarkMode=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/dark_mode","POST",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.searchFriend=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/find_profiles?input=".concat(t),"GET",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.addFriend=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/friends","POST",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.fetchFriends=Object(o.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/friends","GET");case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)}))),I.getFriendQueries=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/friend_queries?username=".concat(t),"GET",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.shareQueries=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/share_queries","POST",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.getSharedQueries=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/shared_queries","GET",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.updateIcon=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/icon","POST",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I.duplicateQueries=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.createRequest("user/duplicate","POST",t);case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var Q=function(){function e(){Object(u.a)(this,e)}return Object(m.a)(e,[{key:"signUpUser",value:function(){var e=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.prev=1,e.next=4,I.signUpUser(t);case 4:return e.abrupt("return",!1);case 7:e.prev=7,e.t0=e.catch(1),this.requestError=!0,this.requestErrorDetail=e.t0.message;case 11:return this.isLoading=!1,e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"loginUser",value:function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoading=!0,e.prev=1,e.next=4,I.signInUser(t);case 4:return a=e.sent,this.userInfo={firstName:a.first_name,lastName:a.last_name},this.authToken=a.token,C.setItem("UserSession",{firstName:this.userInfo.firstName,lastName:this.userInfo.lastName,token:this.authToken}),e.abrupt("return",!1);case 11:e.prev=11,e.t0=e.catch(1),this.requestError=!0,this.requestErrorDetail=e.t0.message;case 15:return this.isLoading=!1,e.abrupt("return",!0);case 17:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resetErrors",value:function(){this.requestError=!1,this.requestErrorDetail=void 0}},{key:"logout",value:function(){this.user=void 0,this.authToken=void 0,this.userInfo=void 0,C.clearItem("UserSession")}},{key:"isSignedIn",get:function(){return this.authToken&&this.authToken.length>0}}]),e}();Object(q.d)(Q,{user:q.f,authToken:q.f,isLoading:q.f,requestError:q.f,requestErrorDetail:q.f,userInfo:q.f,signUpUser:q.b,loginUser:q.b,resetErrors:q.b,logout:q.b,fetchUser:q.b});var F=new Q,P=a(35),T=h.a.Title,M={labelCol:{span:8},wrapperCol:{span:16}},A={wrapperCol:{offset:8,span:16}},V=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={loginFailed:!1},e.onFinish=function(){var t=Object(o.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F.loginUser(a);case 2:(n=t.sent)||(v.a.success("Successfully logged in. Welcome!"),e.props.history.push("/dashboard")),e.setState({loginFailed:n});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onFinishFailed=function(e){console.log("Failed:",e)},e}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(y.a,{style:{width:500}},r.a.createElement("div",{style:{margin:"auto",textAlign:"center"}},r.a.createElement(T,{level:2},"Login")),r.a.createElement(b.a,Object.assign({},M,{name:"basic",initialValues:{remember:!0},onFinish:this.onFinish,onFinishFailed:this.onFinishFailed}),this.state.loginFailed&&r.a.createElement(g.a,{style:{marginBottom:20},message:"Failed to login",type:"error"}),r.a.createElement(b.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(E.a,null)),r.a.createElement(b.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(E.a.Password,null)),r.a.createElement(b.a.Item,Object.assign({},A,{valuePropName:"checked"}),r.a.createElement(k.a,null,"Remember me")),r.a.createElement(b.a.Item,A,r.a.createElement(w.a,{type:"primary",htmlType:"submit"},"Login"))))}}]),a}(r.a.Component),N=Object(P.f)(V),U=a(201),R=h.a.Title,D={labelCol:{span:8},wrapperCol:{span:16}},_={wrapperCol:{offset:8,span:16}},z=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={registerFailed:!1},e.onFinish=function(){var t=Object(o.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F.signUpUser(a);case 2:(n=t.sent)||(v.a.success("Successfully registered!"),e.props.history.push("/login")),e.setState({registerFailed:n});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onFinishFailed=function(e){console.log("Failed:",e)},e}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(y.a,{style:{width:500}},r.a.createElement("div",{style:{margin:"auto",textAlign:"center"}},r.a.createElement(R,{level:2},"Register")),r.a.createElement(b.a,Object.assign({},D,{name:"basic",initialValues:{remember:!0},onFinish:this.onFinish,onFinishFailed:this.onFinishFailed}),this.state.registerFailed&&r.a.createElement(g.a,{style:{marginBottom:20},message:"Failed to register",type:"error"}),r.a.createElement(b.a.Item,{label:"Username",name:"username",rules:[{required:!0,message:"Please input your username!"}]},r.a.createElement(E.a,null)),r.a.createElement(b.a.Item,{label:"First Name",name:"first_name",rules:[{required:!0,message:"Please input your first name!"}]},r.a.createElement(E.a,null)),r.a.createElement(b.a.Item,{label:"Last Name",name:"last_name",rules:[{required:!0,message:"Please input your last name!"}]},r.a.createElement(E.a,null)),r.a.createElement(b.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}]},r.a.createElement(E.a.Password,null)),r.a.createElement(b.a.Item,_,r.a.createElement(w.a,{type:"primary",htmlType:"submit"},"Register"))))}}]),a}(r.a.Component),L=Object(P.f)(z),G=a(83),B=a(845),H=a(113);function J(){var e=Object(f.a)(["\n  float: right;\n"]);return J=function(){return e},e}H.a.SubMenu;var W=U.a.div(J()),Z=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={current:"mail"},e.handleClick=function(t){console.log("click ",t),e.setState({current:t.key})},e}return Object(m.a)(a,[{key:"render",value:function(){return r.a.createElement(W,null,r.a.createElement(H.a,{onClick:this.handleClick,selectedKeys:[this.state.current],mode:"horizontal"},r.a.createElement(H.a.Item,{key:"home"},r.a.createElement(G.b,{to:"/"},"Home")),r.a.createElement(H.a.Item,{key:"register"},r.a.createElement(G.b,{to:"/register"},"Register")),r.a.createElement(H.a.Item,{key:"sigin"},r.a.createElement(G.b,{to:"/login"},"Sign In"))))}}]),a}(r.a.Component),X=a(842),K=a(857),Y=a(856),$=a(855),ee=a(854),te=a(112),ae=a(370),ne=a(371),re=a(212),ie=a(870),ce=a(869),se=a(868),le=a(867),oe=a(866),ue=a(865),me=a(114),de=a(86),pe=a(849),fe=a(841),he=a(846),ve=(de.a.Option,function(e){var t=e.queries,a=e.visible,i=e.onCreate,c=e.onCancel,s=Object(n.useState)(""),u=Object(me.a)(s,2),m=u[0],d=u[1],p=Object(n.useState)([]),f=Object(me.a)(p,2),h=f[0],v=f[1],y=Object(n.useState)([]),g=Object(me.a)(y,2),b=g[0],k=g[1];var w=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.split(":")[0],v([].concat(Object(te.a)(h),[{username:a}])),d("");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(o.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.fetchFriends();case 2:a=e.sent,k(a.map((function(e){return"".concat(e.username,": ").concat(e.firstName," ").concat(e.lastName)})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(pe.a,{visible:a,title:"Share Queries",okText:"Share",cancelText:"Cancel",onCancel:function(){c(),k([]),d(""),v([])},onOk:function(){console.log("test"),console.log(t);for(var e=[],a=0;a<t.length;++a)for(var n=0;n<h.length;++n)e.push({username:h[n].username,qid:t[a]});i(e),k([]),d(""),v([])}},r.a.createElement("div",{style:{display:"flex",width:"100%"}},r.a.createElement(fe.a,{value:m,onChange:function(e){d(e)},options:b.map((function(e){return{value:e}})),style:{width:"100%",justifyContent:"center",margin:"0 auto",display:"block"},onSelect:w,onSearch:q},r.a.createElement(E.a.Search,{size:"large",placeholder:"input here",enterButton:!0}))),r.a.createElement(he.a,{columns:[{title:"Username",dataIndex:"username",key:"username"}],dataSource:h.map((function(e,t){return{id:t,username:e.username}}))}))}),ye=de.a.Option,ge=function(e){var t=e.isCreate,a=e.visible,i=e.onCreate,c=e.onCancel,s=e.query,l=Object(n.useState)(0),o=Object(me.a)(l,2),u=o[0],m=o[1],d=b.a.useForm(),p=Object(me.a)(d,1)[0];return r.a.useEffect((function(){s&&(m(s.database),p.setFieldsValue({database:s.database,employment:s.employment,income:s.income,education:s.education,sex:s.sex,age:s.age}))}),[]),r.a.createElement(pe.a,{visible:a,title:t?"Create search query":"Edit search query",okText:"Create",cancelText:"Cancel",onCancel:c,onOk:function(){s&&"undefined"===typeof p.getFieldsValue().database&&p.setFieldsValue({database:s.database}),s&&"undefined"===typeof p.getFieldsValue().employment&&p.setFieldsValue({employment:s.employment}),s&&"undefined"===typeof p.getFieldsValue().income&&p.setFieldsValue({income:s.income}),s&&"undefined"===typeof p.getFieldsValue().education&&p.setFieldsValue({education:s.education}),s&&"undefined"===typeof p.getFieldsValue().sex&&p.setFieldsValue({sex:s.sex}),s&&"undefined"===typeof p.getFieldsValue().age&&p.setFieldsValue({age:s.age}),p.validateFields().then((function(e){p.resetFields(),i(e)})).catch((function(e){console.log("Validate Failed:",e)}))}},r.a.createElement(b.a,{form:p,layout:"vertical",name:"form_in_modal"},r.a.createElement(b.a.Item,{name:"database",label:"Database",rules:[{required:!0}]},r.a.createElement(de.a,{showSearch:!0,style:{width:"100%"},placeholder:"Select a database",defaultValue:s&&s.database,value:s&&s.database,onChange:function(e){m(e)}},r.a.createElement(ye,{value:"education"},"Education"),r.a.createElement(ye,{value:"employment"},"Employment"),r.a.createElement(ye,{value:"income"},"Income"),r.a.createElement(ye,{value:"population"},"Population"))),"employment"==u?r.a.createElement(b.a.Item,{name:"employment",label:"Employment",rules:[{required:!1}]},r.a.createElement(de.a,{showSearch:!0,mode:"multiple",style:{width:"100%"},placeholder:"Select type of employment",defaultValue:s&&s.employment||[],value:s&&s.employment||[]},r.a.createElement(ye,{value:"employed"},"Employed"),r.a.createElement(ye,{value:"unemployed"},"Unemployed"))):null,"income"==u?r.a.createElement(b.a.Item,{name:"income",label:"Income",rules:[{required:!1}]},r.a.createElement(de.a,{showSearch:!0,mode:"multiple",style:{width:"100%"},placeholder:"Select type of income",defaultValue:s&&s.income||[],value:s&&s.income||[]},r.a.createElement(ye,{value:"market income"},"Market income"),r.a.createElement(ye,{value:"employment income"},"Employment income"),r.a.createElement(ye,{value:"wages, salaries and commissions"},"Wages, salaries and commissions"),r.a.createElement(ye,{value:"net self-employment income"},"Net self-employment income"),r.a.createElement(ye,{value:"investment income"},"Investment income"),r.a.createElement(ye,{value:"private retirement income"},"Private retirement income"),r.a.createElement(ye,{value:"market income not included elsewhere"},"Market income not included elsewhere"),r.a.createElement(ye,{value:"government transfers"},"Government transfers"),r.a.createElement(ye,{value:"OAS and GIS"},"OAS and GIS"),r.a.createElement(ye,{value:"CPP and QPP"},"CPP and QPP"),r.a.createElement(ye,{value:"EI benefits"},"EI benefits"),r.a.createElement(ye,{value:"child benefits"},"Child benefits"),r.a.createElement(ye,{value:"other government transfers"},"Other government transfers"),r.a.createElement(ye,{value:"after-tax income"},"After-tax income"),r.a.createElement(ye,{value:"income taxes"},"Income taxes"))):null,"education"==u?r.a.createElement(b.a.Item,{name:"education",label:"Education",rules:[{required:!1}]},r.a.createElement(de.a,{showSearch:!0,mode:"multiple",style:{width:"100%"},placeholder:"Select level of education",defaultValue:s&&s.education||[],value:s&&s.education||[]},r.a.createElement(ye,{value:"no certificate, diploma or degree"},"No certificate, diploma or degree"),r.a.createElement(ye,{value:"secondary (high) school diploma or equivalency certificate"},"Secondary (high) school diploma or equivalency certificate"),r.a.createElement(ye,{value:"postsecondary certificate, diploma or degree"},"Postsecondary certificate, diploma or degree"),r.a.createElement(ye,{value:"apprenticeship or trades certificate or diploma"},"Apprenticeship or trades certificate or diploma"),r.a.createElement(ye,{value:"trades certificate or diploma other than Certificate of Apprenticeship or Certificate of Qualification"},"Trades certificate or diploma other than Certificate of Apprenticeship or Certificate of Qualification"),r.a.createElement(ye,{value:"certificate of Apprenticeship or Certificate of Qualification"},"Certificate of Apprenticeship or Certificate of Qualification"),r.a.createElement(ye,{value:"college, CEGEP or other non-university certificate or diploma"},"College, CEGEP or other non-university certificate or diploma"),r.a.createElement(ye,{value:"university certificate or diploma below bachelor level"},"University certificate or diploma below bachelor level"),r.a.createElement(ye,{value:"university certificate, diploma or degree at bachelor level or above"},"University certificate, diploma or degree at bachelor level or above"),r.a.createElement(ye,{value:"bachelor's degree"},"Bachelor's degree"),r.a.createElement(ye,{value:"university certificate or diploma above bachelor level"},"University certificate or diploma above bachelor level"),r.a.createElement(ye,{value:"degree in medicine, dentistry, veterinary medicine or optometry"},"Degree in medicine, dentistry, veterinary medicine or optometry"),r.a.createElement(ye,{value:"master's degree"},"Master's degree"),r.a.createElement(ye,{value:"earned doctorate"},"Earned doctorate"))):null,r.a.createElement(b.a.Item,{name:"sex",label:"Sex Constraint",rules:[{required:!1}]},r.a.createElement(de.a,{showSearch:!0,mode:"multiple",style:{width:"100%"},placeholder:"Select a sex",defaultValue:s&&s.sex||["male","female"],optionFilterProp:"male",value:s&&s.sex||["male","female"]},r.a.createElement(ye,{value:"male"},"Male"),r.a.createElement(ye,{value:"female"},"Female"))),r.a.createElement(b.a.Item,{name:"age",label:"Age Constraint",rules:[{required:!1}]},r.a.createElement(de.a,{showSearch:!0,mode:"multiple",style:{width:"100%"},placeholder:"Select age intervals",defaultValue:s&&s.age||[],value:s&&s.age||[]},r.a.createElement(ye,{value:"15-24"},"15-24"),r.a.createElement(ye,{value:"25-34"},"25-34"),r.a.createElement(ye,{value:"35-44"},"35-44"),r.a.createElement(ye,{value:"45-54"},"45-54"),r.a.createElement(ye,{value:"55-64"},"55-64"),r.a.createElement(ye,{value:"65+"},"65+")))))},be=(a(572),function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"render",value:function(){for(var e=this.props,t=e.minimum,a=e.maximum,n=e.color,i=e.units,c=e.queryId,s=[],l=(a-t)/4,o=a;o>=0;o-=l)"people"!=i?s.push(o.toFixed(2)):s.push(Math.round(o));return r.a.createElement("div",{className:"floatleft"},r.a.createElement("h4",null,r.a.createElement("span",{style:{backgroundColor:n}}),"Query "+c),r.a.createElement("div",{id:"state-legend",className:"legend"},s.map((function(e,t){return r.a.createElement("h4",null,r.a.createElement("span",{style:{backgroundColor:n,opacity:(s.length-t)/s.length}}),e)}))),r.a.createElement("p",{id:"legend-units"},"All values in "+i))}}]),a}(r.a.Component)),Ee=(a(827),a(828),a(366)),ke=a.n(Ee),we=a(205),qe=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).colors=[[69,195,229],[229,181,69],[184,69,229],[147,229,69],[229,93,69],[229,138,69],[69,229,203]],n.changeColor=function(e){if(n.state.selected){n.setState({color:e});var t=n.props.queries,a=t.findIndex((function(e){return e.qid===n.state.selected}));t[a].heatmap.paint["heatmap-color"]=n.makeNewColors(n.colors[e]),t[a].selected=!1,t[a].postSelect=!0,n.props.onColorChange(n.state.selected,e),n.props.onChange(t)}},n.changeCurve=function(e){if(n.state.selected){n.setState({curve:e});var t=n.props.queries,a=t.findIndex((function(e){return e.qid===n.state.selected})),r=function(e,t){return e>t?e:t},i=function(e,t){return e<t?e:t},c=t[a].heatmap.paint["heatmap-weight"][5],s=["interpolate",["cubic-bezier",r(e[0],0),i(e[1],1),r(e[2],0),i(e[3],1)],["get","mag"],0,0,c,1];t[a].heatmap.paint["heatmap-weight"]=s,t[a].selected=!1,t[a].postSelect=!0,n.props.onChange(t)}},n.resetCurve=function(){n.changeCurve([0,0,1,1])},n.save=function(){if(n.state.selected){var e=n.props.dtos,t=e.findIndex((function(e){return e.query.qid===n.state.selected})),a=e[t].query;a.color=n.state.color,a.curve=n.state.curve,n.props.onSaveDto(a)}},n.state={curve:[0,0,1,1],color:null,selected:null},n}return Object(m.a)(a,[{key:"componentWillReceiveProps",value:function(e,t){this.state.selected||0===e.queries.length?this.state.selected&&0===e.queries.length&&this.setState({selected:null}):this.setState({selected:e.queries[0].qid})}},{key:"makeNewColors",value:function(e){var t=e[0],a=e[1],n=e[2];return["interpolate",["linear"],["heatmap-density"],0,"rgba(".concat(t,",").concat(a,",").concat(n,",0)"),.2,"rgba(".concat(t,",").concat(a,",").concat(n,",0.2)"),.4,"rgba(".concat(t,",").concat(a,",").concat(n,",0.4)"),.6,"rgba(".concat(t,",").concat(a,",").concat(n,",0.6)"),.8,"rgba(".concat(t,",").concat(a,",").concat(n,",0.8)"),.9,"rgba(".concat(t,",").concat(a,",").concat(n,",1)")]}},{key:"componentWillUpdate",value:function(e,t,a){if(this.state.selected!==t.selected)if(t.selected){var n=this.props.dtos,r=n.findIndex((function(e){return e.query.qid===t.selected})),i=n[r].query;console.log("selected"),console.log(i),this.setState({color:i.color,curve:i.curve?i.curve:[0,0,1,1]})}else this.setState({color:null,curve:[0,0,1,1]})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"editor-base"},r.a.createElement("h3",null,"Edit query visuals"),r.a.createElement("span",null,"Query"),r.a.createElement(de.a,{value:this.state.selected,onChange:function(t){return e.setState({selected:t})}},this.props.queries.map((function(e){return r.a.createElement(de.a.Option,{value:e.qid},"Query ",e.qid)}))),r.a.createElement("span",null,"Color"),r.a.createElement(we.default.Group,{style:{display:"inline-flex",direction:"row"},value:this.state.color,onChange:function(t){return e.changeColor(t.target.value)}},r.a.createElement(we.default.Button,{value:0,style:{padding:0}},r.a.createElement("div",{className:"swatch1"})),r.a.createElement(we.default.Button,{value:1,style:{padding:0}},r.a.createElement("div",{className:"swatch2"})),r.a.createElement(we.default.Button,{value:2,style:{padding:0}},r.a.createElement("div",{className:"swatch3"})),r.a.createElement(we.default.Button,{value:3,style:{padding:0}},r.a.createElement("div",{className:"swatch4"})),r.a.createElement(we.default.Button,{value:4,style:{padding:0}},r.a.createElement("div",{className:"swatch5"})),r.a.createElement(we.default.Button,{value:5,style:{padding:0}},r.a.createElement("div",{className:"swatch6"}))),r.a.createElement("span",null,"Data curve"),r.a.createElement(ke.a,{className:"editor",value:this.state.curve,onChange:function(t){return e.changeCurve(t)},width:200,height:200,handleColor:"#1890ff"}),r.a.createElement(w.a,{onClick:this.resetCurve,style:{marginBottom:8,marginTop:4}},"Reset Curve"),r.a.createElement(w.a,{type:"primary",onClick:this.save},"Save"))}}]),a}(n.Component),xe=X.a.Sider,Se=X.a.Content,Ce=h.a.Title,Oe={1:"total education",2:"no certificate, diploma or degree",3:"secondary (high) school diploma or equivalency certificate",4:"postsecondary certificate, diploma or degree",5:"apprenticeship or trades certificate or diploma",6:"trades certificate or diploma other than Certificate of Apprenticeship or Certificate of Qualification",7:"certificate of Apprenticeship or Certificate of Qualification",8:"college, CEGEP or other non-university certificate or diploma",9:"university certificate or diploma below bachelor level",10:"university certificate, diploma or degree at bachelor level or above",11:"bachelor's degree",12:"university certificate or diploma above bachelor level",13:"degree in medicine, dentistry, veterinary medicine or optometry",14:"master's degree",15:"earned doctorate"},je={"total education":1,"no certificate, diploma or degree":2,"secondary (high) school diploma or equivalency certificate":3,"postsecondary certificate, diploma or degree":4,"apprenticeship or trades certificate or diploma":5,"trades certificate or diploma other than Certificate of Apprenticeship or Certificate of Qualification":6,"certificate of Apprenticeship or Certificate of Qualification":7,"college, CEGEP or other non-university certificate or diploma":8,"university certificate or diploma below bachelor level":9,"university certificate, diploma or degree at bachelor level or above":10,"bachelor's degree":11,"university certificate or diploma above bachelor level":12,"degree in medicine, dentistry, veterinary medicine or optometry":13,"master's degree":14,"earned doctorate":15},Ie={1:"total income",2:"market income",3:"employment income",4:"wages, salaries and commissions",5:"net self-employment income",6:"investment income",7:"private retirement income",8:"market income not included elsewhere",9:"government transfers",10:"OAS and GIS",11:"CPP and QPP",12:"EI benefits",13:"child benefits",14:"other government transfers",15:"after-tax income",16:"income taxes"},Qe={"total income":1,"market income":2,"employment income":3,"wages, salaries and commissions":4,"net self-employment income":5,"investment income":6,"private retirement income":7,"market income not included elsewhere":8,"government transfers":9,"OAS and GIS":10,"CPP and QPP":11,"EI benefits":12,"child benefits":13,"other government transfers":14,"after-tax income":15,"income taxes":16},Fe={1:"malefemale",2:"male",3:"female"},Pe={malefemale:1,male:2,female:3},Te={1:"all",2:"15-24",5:"25-34",6:"35-44",7:"45-54",8:"55-64",9:"65+"},Me={all:1,"15-24":2,"25-34":5,"35-44":6,"45-54":7,"55-64":8,"65+":9},Ae={1:"employed",2:"unemployed"},Ve={employed:1,unemployed:2},Ne=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(u.a)(this,a),(n=t.call(this,e)).saveDto=function(){var e=Object(o.a)(l.a.mark((function e(t){var a,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,n.saveQuery(t);case 3:a=e.sent,console.log(a),a&&(r=n.state.queries,i=r.findIndex((function(e){return e.query.qid===t.qid})),r[i].query=t,n.setState({queries:r}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.toggleQuerySelected=function(e){var t=n.state.queries;t[e].selected=!t[e].selected,n.setState({queries:t})},n.toggleResultSelected=function(e){var t=n.state.queryResults;t[e].selected=!t[e].selected,n.setState({queryResults:t})},n.toggleModalVisible=function(e){var t=n.state.queries;t[e].modalVisible=!t[e].modalVisible,n.setState({queries:t})},n.queryExists=function(e,t){var a=n.state.queries;e=e.query;for(var r=0;r<a.length&&r!==t;++r){var i=a[r].query;if(e.database===i.database&&e.sex===i.sex&&e.income===i.income&&e.education===i.education&&e.employment===i.employment&&e.age===i.age)return r}return-1},n.querySelected=function(){for(var e=0;e<n.state.queries.length;++e)if(n.state.queries[e].selected)return!0;return!1},n.buildQueryArrayHelper=function(e){for(var t="",a=0;a<e.length;++a)t+=" ".concat(e[a]),a<e.length-1&&(t+=",");return t},n.buildQuery=function(e){if(void 0!==e){var t=e.database,a=e.age,r=e.sex,i=e.employment,c=e.income,s=e.education,l="";return l+="Showing","employment"===t?i&&0!=i.length&&2!=i.length?l+=n.buildQueryArrayHelper(i):l+=" total employment":"income"===t?c&&0!=c.length&&15!=c.length?l+=n.buildQueryArrayHelper(c):l+=" total income":"education"===t&&(s&&0!=s.length&&14!=s.length?l+=n.buildQueryArrayHelper(s):l+=" total education"),l+=" from ".concat(t),r&&1==r.length&&(l+=" where sex is ",l+=n.buildQueryArrayHelper(r)),r&&a&&a.length>0&&(l+=" and"),a&&a.length>0&&(l+=" where age is ",l+=n.buildQueryArrayHelper(a)),l}},n.onViewportChange=function(e){e.width,e.height;var t=Object(ne.a)(e,["width","height"]);n.setState({viewport:t})},n.overrideColor=function(e,t){var a={};n.state.overrides&&(a=Object(ae.a)({},n.state.overrides)),a[e]=t,console.log(a),n.setState({overrides:a})},n.colors=[[69,195,229],[229,181,69],[184,69,229],[147,229,69],[229,93,69],[229,138,69],[69,229,203]];var r=(new Date).getTime();return n.state={viewport:{latitude:43.4643,longitude:-80.5204,zoom:8,maxZoom:8.4},selectedTime:r,modalVisible:!1,mapStyle:"",queries:[],sharedQueries:[],queryResults:[],isLoading:!1,username:"",shareModalVisible:!1},n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.fetchData(),this.setMapStyle()}},{key:"setMapStyle",value:function(){var e=Object(o.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getUserMe();case 2:(t=e.sent)&&t.dark_mode?this.setState({mapStyle:"mapbox://styles/mapbox/dark-v9",username:t.user_name}):this.setState({mapStyle:"mapbox://styles/mapbox/light-v9",username:t.user_name});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchData",value:function(){var e=Object(o.a)(l.a.mark((function e(){var t,a,n,r,i,c,s,o,u,m,d,p,f,h,v,y,g;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.fetchAllQueries();case 2:return t=e.sent,e.next=5,I.getSharedQueries();case 5:for(a=e.sent,console.log("ETSTETSET"),console.log(a),n=[].concat(Object(te.a)(t),Object(te.a)(a)),r=[],i=0;i<n.length;++i){if(c=n[i],s=[],o=[],u=[],m=[],1!==c.params.length||1!==c.params[0])if("education"===c.dataset)for(d=0;d<c.params.length;++d)s.push(Oe[c.params[d]]);else if("employment"===c.dataset)for(p=0;p<c.params.length;++p)u.push(Ae[c.params[p]]);else if("income"===c.dataset)for(f=0;f<c.params.length;++f)o.push(Ie[c.params[f]]);if(h=c.sex&&1!==c.sex?[Fe[c.sex]]:["male","female"],c.age)for(v=0;v<c.age.length;++v)1!==c.age[v]&&m.push(Te[c.age[v]]);y={qid:c.qid,database:c.dataset,education:s,income:o,employment:u,sex:h,age:m,color:c.color,curve:c.curve},g={query:y,selected:!1,modalVisible:!1},r.push(g)}this.setState({queries:r});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addQueryToBuilder",value:function(){var e=Object(o.a)(l.a.mark((function e(t){var a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.state.queries,n={query:t,selected:!1,modalVisible:!1},-1!==this.queryExists(n,-1)){e.next=8;break}return e.next=5,this.saveQuery(n.query);case 5:r=e.sent,n.query.qid=r[0],a.push(n);case 8:this.setState({modalVisible:!1,queries:a});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"copyQueries",value:function(){var e=Object(o.a)(l.a.mark((function e(){var t,a,n,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.state.queries,a="",n=!0,r=0;r<t.length;++r)t[r].selected&&(n?(n=!n,a+=t[r].query.qid):a+=", "+t[r].query.qid);i="Select "+a+" from "+this.state.username,navigator.clipboard.writeText(i);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"saveQuery",value:function(){var e=Object(o.a)(l.a.mark((function e(t){var a,n,r,i,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],"education"===t.database)if(t.education&&0!==t.education.length&&14!==t.education.length)for(n=0;n<t.education.length;++n)a.push(je[t.education[n]]);else a.push(1);else if("employment"===t.database)t.employment&&0!==t.employment.length&&2!==t.employment.length?a.push(Ve[t.employment[0]]):(a.push(1),a.push(2));else if("income"===t.database)if(t.income&&0!==t.income.length&&14!==t.income.length)for(r=0;r<t.income.length;++r)a.push(Qe[t.income[r]]);else a.push(1);if(i=[{dataset:t.database,params:a}],t.age&&t.age.length>1){for(c=[],s=0;s<t.age.length;++s)c.push(Me[t.age[s]]);i[0].age=c}else i[0].age=[1];return t.sex&&1==t.sex.length?i[0].sex=Pe[t.sex[0]]:i[0].sex=1,t.qid&&(i[0].qid=t.qid),t.color&&(i[0].color=t.color),t.curve&&(i[0].curve=t.curve),e.next=10,I.saveQuery(i);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteQueries",value:function(){var e=Object(o.a)(l.a.mark((function e(){var t,a,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.state.queries,a=[],n=t.length,r=0;r<n;++r)t[r].selected&&(a.push(t[r].query.qid),t.splice(r,1),--r,--n);return this.setState({queries:t}),e.next=7,this.deleteQueriesAPI(a);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteQueriesAPI",value:function(){var e=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.deleteQueries(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"runQueries",value:function(){var e=Object(o.a)(l.a.mark((function e(){var t,a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({queryResults:[],isLoading:!0}),t=this.queriesSelected(),e.next=4,I.runQueries(t);case 4:for(a=e.sent,n=0;n<a.length;++n)0===n?a[0].selected=!0:a[n].selected=!1,a[n].qid=t[n];this.setState({queryResults:a,isLoading:!1});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shareMyQueries",value:function(){var e=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.shareQueries(t);case 2:this.setState({shareModalVisible:!1});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queriesSelected",value:function(){for(var e=this.state.queries,t=[],a=e.length,n=0;n<a;++n)e[n].selected&&t.push(e[n].query.qid);return t}},{key:"componentDidUpdate",value:function(e,t,a){if(this.state.queryResults){for(var n=!1,r=this.state.queryResults,i=0;i<r.length;i++)r[i].postSelect&&(n=!0,r[i].selected=!0,r[i].postSelect=!1);n&&this.setState({queryResults:r})}}},{key:"render",value:function(){var e=this,t=this.state,a=(t.viewport,t.data,t.allDay,t.selectedTime,t.startTime,t.endTime,t.mapStyle);t.isShowFirstLayer,t.isShowSecondLayer;return r.a.createElement(X.a,{style:{minHeight:"100%"}},r.a.createElement(ge,{isCreate:!0,visible:this.state.modalVisible,onCreate:function(t){"undefined"!=typeof t.sex&&0==t.sex.length&&(t.sex=["male","female"]),e.addQueryToBuilder(t)},onCancel:function(){e.setState({modalVisible:!1})}}),r.a.createElement(ve,{visible:this.state.shareModalVisible,queries:this.queriesSelected(),onCreate:function(t){e.shareMyQueries(t)},onCancel:function(){e.setState({shareModalVisible:!1})}}),r.a.createElement(xe,{theme:"light",collapsible:!1,collapsed:!1,width:400,style:{padding:20}},r.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},r.a.createElement(Ce,{level:3},"Query Builder"),r.a.createElement(w.a,{type:"dashed",onClick:function(){return e.setState({modalVisible:!0})},icon:r.a.createElement(ce.a,null)}),r.a.createElement(w.a,{type:"dashed",disabled:!this.querySelected(),onClick:function(){return e.setState({shareModalVisible:!0})},icon:r.a.createElement(se.a,null)}),r.a.createElement(w.a,{type:"dashed",disabled:!this.querySelected(),onClick:function(){return e.deleteQueries()},icon:r.a.createElement(le.a,null)}),r.a.createElement(w.a,{type:"dashed",loading:this.state.isLoading,disabled:!this.querySelected(),onClick:function(){return e.runQueries()},icon:r.a.createElement(oe.a,null)}),r.a.createElement("br",null)),r.a.createElement(ie.b,null,this.state.queries.map((function(t,a){return r.a.createElement("div",null,r.a.createElement(ge,{isCreate:!1,visible:t.modalVisible,onCreate:function(t){var n=e.state.queries;t.qid=n[a].query.qid,n[a].query=t,n[a].modalVisible=!1,-1!==e.queryExists(n[a],a)?(e.deleteQueries([n[a].query.qid]),n.splice(a,1)):e.saveQuery(n[a].query),e.setState({queries:n})},onCancel:function(){e.toggleModalVisible(a)},query:t.query}),r.a.createElement(ie.b.Item,null,r.a.createElement(k.a,{checked:t.selected,onChange:function(){return e.toggleQuerySelected(a)}},e.buildQuery(t.query)," (Query ",r.a.createElement("b",null,t.query.qid),")"),r.a.createElement(w.a,{type:"dashed",onClick:function(){return e.toggleModalVisible(a)},icon:r.a.createElement(ue.a,null)})))})))),r.a.createElement(X.a,null,r.a.createElement(Se,null,r.a.createElement("div",{style:{height:"100%",position:"relative"}},r.a.createElement(re.c,Object.assign({width:"100%",height:"100%",mapStyle:a},this.state.viewport,{onViewportChange:function(t){return e.onViewportChange(t)},mapboxApiAccessToken:"pk.eyJ1IjoidHBpbnRvNyIsImEiOiJja2JicWYwMzkwM3NnMnNtZnZkbXU5dGhkIn0.NdzHwoMYvZ-fSTIA9xXXfw"}),this.state.queryResults.map((function(e){return e.selected&&r.a.createElement(re.b,{id:"layer"+e.qid,type:"geojson",data:e.layer},r.a.createElement(re.a,Object.assign({id:"layer"+e.qid},e.heatmap)))}))),r.a.createElement("div",{className:"control-panel"},r.a.createElement("h3",null,"Heatmap"),r.a.createElement("hr",null),this.state.queryResults.map((function(t,a){return r.a.createElement("div",null,r.a.createElement(k.a,{checked:t.selected,onChange:function(){return e.toggleResultSelected(a)}})," Query ",t.qid)}))),r.a.createElement("div",{className:"map-legends"},this.state.queryResults.map((function(t,a){if(t.selected){var n=e.state.queries.find((function(e){return e.query.qid===t.qid}));if(n){var i=n.query,c=t.hue;if(i&&i.color){var s=e.colors[i.color];c="rgb(".concat(s[0],",").concat(s[1],",").concat(s[2],")")}if(e.state.overrides&&void 0!==e.state.overrides[t.qid]){var l=e.colors[e.state.overrides[t.qid]];c="rgb(".concat(l[0],",").concat(l[1],",").concat(l[2],")")}return r.a.createElement(be,{minimum:t.min,maximum:t.max,color:c,units:t.units,queryId:t.qid})}}}))),r.a.createElement("div",{className:"control-panel2"},r.a.createElement(qe,{queries:this.state.queryResults,dtos:this.state.queries,onChange:function(t){e.setState({queryResults:t})},onColorChange:function(t,a){return e.overrideColor(t,a)},onSaveDto:function(t){return e.saveDto(t)}}))))))}}]),a}(n.Component),Ue=a(143),Re=a(73),De=a(843),_e=a(852),ze=a(871),Le=a(864),Ge=a(863),Be=a(862),He=a(861),Je=a(860),We=a(872),Ze=a(859),Xe=a(858),Ke={0:r.a.createElement(Le.a,null),1:r.a.createElement(Ge.a,null),2:r.a.createElement(Be.a,null),3:r.a.createElement(He.a,null),4:r.a.createElement(Je.a,null),5:r.a.createElement(We.a,null),6:r.a.createElement(Ze.a,null),7:r.a.createElement(Xe.a,null)},Ye=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).toggleDarkMode=function(){var e=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=5;break}return e.next=3,I.updateDarkMode(!0);case 3:e.next=7;break;case 5:return e.next=7,I.updateDarkMode(!1);case 7:n.setState({isDarkModeEnabled:t});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={username:"",first:"",last:"",numQueries:0,isDarkModeEnabled:!1,showModal:!1,icon:0},n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.fetchUserInfo()}},{key:"fetchUserInfo",value:function(){var e=Object(o.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getUserMe();case 2:t=e.sent,this.setState({username:t.user_name,first:t.first_name,last:t.last_name,numQueries:t.num_queries,isDarkModeEnabled:t.dark_mode,icon:t.icon});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateIcon",value:function(){var e=Object(o.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.updateIcon(t);case 2:this.setState({icon:t,showModal:!1});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(X.a,{style:{minHeight:"100%"}},r.a.createElement(Ue.a,{align:"middle"},r.a.createElement(Re.a,{span:12,offset:6},r.a.createElement(y.a,{style:{textAlign:"center"}},r.a.createElement("div",null,r.a.createElement(De.a,{size:64,icon:Ke[this.state.icon],onClick:function(){return e.setState({showModal:!0})}})),r.a.createElement(_e.a,{style:{marginTop:"20px"},title:"User Info"},r.a.createElement(_e.a.Item,{label:"Username"},this.state.username),r.a.createElement(_e.a.Item,{label:"First Name"},this.state.first),r.a.createElement(_e.a.Item,{label:"Last Name"},this.state.last),r.a.createElement(_e.a.Item,{label:"Number Of Queries"},this.state.numQueries)),r.a.createElement("div",null,"Dark Mode ",r.a.createElement(ze.a,{checked:this.state.isDarkModeEnabled,onChange:this.toggleDarkMode}))))),r.a.createElement(pe.a,{title:"Set Profile Icon",centered:!0,visible:this.state.showModal,onOk:function(){return e.setState({showModal:!1})},onCancel:function(){return e.setState({showModal:!1})},footer:[r.a.createElement(w.a,{key:"back",onClick:function(){return e.setState({showModal:!1})}},"Close")]},r.a.createElement(Ue.a,null,r.a.createElement(Re.a,{span:6},r.a.createElement(De.a,{size:48,onClick:function(){return e.updateIcon(0)},icon:r.a.createElement(Le.a,null)})),r.a.createElement(Re.a,{span:6},r.a.createElement(De.a,{size:48,onClick:function(){return e.updateIcon(1)},icon:r.a.createElement(Ge.a,null)})),r.a.createElement(Re.a,{span:6},r.a.createElement(De.a,{size:48,onClick:function(){return e.updateIcon(2)},icon:r.a.createElement(Be.a,null)})),r.a.createElement(Re.a,{span:6},r.a.createElement(De.a,{size:48,onClick:function(){return e.updateIcon(3)},icon:r.a.createElement(He.a,null)}))),r.a.createElement("br",null),r.a.createElement(Ue.a,null,r.a.createElement(Re.a,{span:6},r.a.createElement(De.a,{size:48,onClick:function(){return e.updateIcon(4)},icon:r.a.createElement(Je.a,null)})),r.a.createElement(Re.a,{span:6},r.a.createElement(De.a,{size:48,onClick:function(){return e.updateIcon(5)},icon:r.a.createElement(We.a,null)})),r.a.createElement(Re.a,{span:6},r.a.createElement(De.a,{size:48,onClick:function(){return e.updateIcon(6)},icon:r.a.createElement(Ze.a,null)})),r.a.createElement(Re.a,{span:6},r.a.createElement(De.a,{size:48,onClick:function(){return e.updateIcon(7)},icon:r.a.createElement(Xe.a,null)})))))}}]),a}(n.Component),$e=a(844),et=h.a.Title,tt={1:"total education",2:"no certificate, diploma or degree",3:"secondary (high) school diploma or equivalency certificate",4:"postsecondary certificate, diploma or degree",5:"apprenticeship or trades certificate or diploma",6:"trades certificate or diploma other than Certificate of Apprenticeship or Certificate of Qualification",7:"certificate of Apprenticeship or Certificate of Qualification",8:"college, CEGEP or other non-university certificate or diploma",9:"university certificate or diploma below bachelor level",10:"university certificate, diploma or degree at bachelor level or above",11:"bachelor's degree",12:"university certificate or diploma above bachelor level",13:"degree in medicine, dentistry, veterinary medicine or optometry",14:"master's degree",15:"earned doctorate"},at={1:"total income",2:"market income",3:"employment income",4:"wages, salaries and commissions",5:"net self-employment income",6:"investment income",7:"private retirement income",8:"market income not included elsewhere",9:"government transfers",10:"OAS and GIS",11:"CPP and QPP",12:"EI benefits",13:"child benefits",14:"other government transfers",15:"after-tax income",16:"income taxes"},nt={1:"malefemale",2:"male",3:"female"},rt={1:"all",2:"15-24",5:"25-34",6:"35-44",7:"45-54",8:"55-64",9:"65+"},it=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={entries:[],friends:[],value:"",showModal:!1,modalUsername:"",queries:[]},e.columns=[{title:"Username",dataIndex:"username",key:"username"},{title:"Action",key:"action",render:function(t,a){return r.a.createElement($e.a,{size:"middle",onClick:function(){return e.getUserQueries(a.username)}},r.a.createElement("a",null,"Show Queries"))}}],e.queryColumns=[{title:"Selected",key:"selected",render:function(t,a){return r.a.createElement(k.a,{checked:a.query.selected,onChange:function(){return e.toggleQuerySelected(a)}})}},{title:"Query",dataIndex:"query",key:"query",render:function(t,a){return e.buildQuery(a.query)}}],e.toggleQuerySelected=function(t){console.log(t);var a=e.state.queries;a[t.id].selected=!a[t.id].selected,e.setState({queries:a})},e.buildQuery=function(t){if(void 0!==t){var a=t.database,n=t.age,r=t.sex,i=t.income,c=t.education,s="";return s+="Showing","employment"===a?i&&0!=i.length&&15!=i.length?s+=e.buildQueryArrayHelper(i):s+=" total income":"education"===a&&(c&&0!=c.length&&14!=c.length?s+=e.buildQueryArrayHelper(c):s+=" total education"),s+=" from ".concat(a),r&&(r.length,s+=" where sex is ",s+=e.buildQueryArrayHelper(r)),r&&n&&n.length>0&&(s+=" and"),n&&n.length>0&&(s+=" where age is ",s+=e.buildQueryArrayHelper(n)),s}},e.buildQueryArrayHelper=function(e){for(var t="",a=0;a<e.length;++a)t+=" ".concat(e[a]),a<e.length-1&&(t+=",");return t},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this;I.fetchFriends().then((function(t){e.setState({friends:t})}))}},{key:"shareQueries",value:function(){var e=Object(o.a)(l.a.mark((function e(){var t,a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.state.queries,this.state.modalUsername,a=[],n=0;n<t.length;++n)t[n].selected&&a.push(t[n].qid);return console.log(a),e.next=7,I.duplicateQueries(a);case 7:this.setState({showModal:!1,modalUsername:"",queries:[]});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserQueries",value:function(){var e=Object(o.a)(l.a.mark((function e(t){var a,n,r,i,c,s,o,u,m,d,p,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.getFriendQueries(t);case 2:for(a=e.sent,n=[],r=0;r<a.length;++r){if(i=a[r],c=[],s=[],[],u=[],1!=i.params.length||1!=i.params[0])if("education"===i.dataset)for(m=0;m<i.params.length;++m)c.push(tt[i.params[m]]);else if("employment"===i.dataset)for(d=0;d<i.params.length;++d)s.push(at[i.params[d]]);if(o=i.sex&&1!==i.sex?[nt[i.sex]]:["male","female"],i.age)for(p=0;p<i.age.length;++p)1!==i.age[p]&&u.push(rt[i.age[p]]);f={qid:i.qid,database:i.dataset,education:c,income:s,sex:o,age:u,selected:!1},n.push(f)}console.log(n),this.setState({showModal:!0,modalUsername:t,queries:n});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=function(){var t=Object(o.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.split(":")[0],t.next=3,I.addFriend([n]);case 3:e.setState({friends:[].concat(Object(te.a)(e.state.friends),[{username:n}]),value:""}),v.a.success("Successfully added ".concat(n));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",margin:30}},r.a.createElement(et,{level:4},"Add Friends"),r.a.createElement("div",{style:{display:"flex",width:"100%"}},r.a.createElement(fe.a,{value:this.state.value,onChange:function(t){e.setState({value:t})},options:this.state.entries.map((function(e){return{value:e}})),style:{width:"100%",justifyContent:"center",margin:"0 auto",display:"block"},onSelect:t,onSearch:function(t){I.searchFriend(t).then((function(t){e.setState({entries:t.map((function(e){return"".concat(e.username,": ").concat(e.firstName," ").concat(e.lastName)}))})}))}},r.a.createElement(E.a.Search,{size:"large",placeholder:"input here",enterButton:!0}))),r.a.createElement("div",{style:{paddingTop:20}}),r.a.createElement(et,{level:4},"Friends List"),r.a.createElement(he.a,{columns:this.columns,dataSource:this.state.friends.map((function(e,t){return{id:t,username:e.username}}))}),r.a.createElement(pe.a,{title:"Queries for ".concat(this.state.modalUsername),centered:!0,visible:this.state.showModal,onOk:function(){return e.setState({showModal:!1})},onCancel:function(){return e.setState({showModal:!1})},footer:[r.a.createElement(w.a,{key:"back",onClick:function(){return e.setState({showModal:!1})}},"Close"),r.a.createElement(w.a,{key:"back",onClick:function(){return e.shareQueries()}},"Copy")]},r.a.createElement(he.a,{columns:this.queryColumns,dataSource:this.state.queries.map((function(e,t){return{id:t,query:e}}))})))}}]),a}(r.a.Component),ct=X.a.Sider;var st=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={collapsed:!1,page:0},e.onCollapse=function(t){console.log(t),e.setState({collapsed:t})},e.onChange=function(e){console.log("checked = ".concat(e.target.checked))},e}return Object(m.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(X.a,{style:{minHeight:"100vh"}},r.a.createElement(ct,{collapsible:!0,collapsed:this.state.collapsed,onCollapse:this.onCollapse},r.a.createElement("div",{className:"logo"}),r.a.createElement(H.a,{theme:"dark",defaultSelectedKeys:["1"],mode:"inline"},r.a.createElement(H.a.Item,{key:"1",icon:r.a.createElement(K.a,null),onClick:function(){return e.setState({page:0})}},"Visualization"),r.a.createElement(H.a.Item,{key:"2",icon:r.a.createElement(Y.a,null),onClick:function(){return e.setState({page:1})}},"Friends"),r.a.createElement(H.a.Item,{key:"3",icon:r.a.createElement($.a,null),onClick:function(){return e.setState({page:2})}},"Account Settings"),r.a.createElement(H.a.Item,{key:"4",icon:r.a.createElement(ee.a,null)},r.a.createElement(G.b,{to:"/"},"Log out")))),r.a.createElement(X.a,{className:"site-layout"},r.a.createElement("div",{style:{height:"100%",position:"relative"}},0===this.state.page&&r.a.createElement(Ne,null),1===this.state.page&&r.a.createElement(it,null),2===this.state.page&&r.a.createElement(Ye,null))))}}]),a}(r.a.Component);function lt(){var e=Object(f.a)(["\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n  transform: translate(-50%, -50%);\n"]);return lt=function(){return e},e}var ot=h.a.Title,ut=U.a.div(lt()),mt=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={loading:!0},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=Object(o.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.fetchItems();case 2:this.setState({loading:!1});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return!this.state.loading&&r.a.createElement(B.a,null,(function(){return r.a.createElement(G.a,null,r.a.createElement(P.c,null,r.a.createElement(P.a,{path:"/login"},r.a.createElement(Z,null),r.a.createElement(ut,null,r.a.createElement(N,null))),r.a.createElement(P.a,{path:"/register"},r.a.createElement(Z,null),r.a.createElement(ut,null,r.a.createElement(L,null))),r.a.createElement(P.a,{path:"/dashboard"},r.a.createElement(st,null)),r.a.createElement(P.a,{path:"/"},r.a.createElement(Z,null),r.a.createElement(ut,null,r.a.createElement(ot,{level:1,style:{textAlign:"center"}},"CS 348 Project"),r.a.createElement(ot,{level:3,style:{textAlign:"center"}},"Census Data Visualization")))))}))}}]),a}(r.a.Component);a(838);c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(mt,null)),document.getElementById("root"))}},[[373,1,2]]]);
//# sourceMappingURL=main.e8ce7a92.chunk.js.map